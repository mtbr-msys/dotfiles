#!/bin/bash
set -euo pipefail

pull_repo() {
    local dest="$1"

    if [ -d "$dest/.git" ]; then
        git -C "$dest" pull --ff-only
    fi
}

# JAVA
if command -v jenv >/dev/null 2>&1; then
    pull_repo "$(jenv root)"
fi

# node
if command -v nodenv >/dev/null 2>&1; then
    nodenv_root="$(nodenv root)"
    pull_repo "$nodenv_root"
    pull_repo "$nodenv_root/plugins/node-build"
fi

# ruby
if command -v rbenv >/dev/null 2>&1; then
    rbenv_root="$(rbenv root)"
    pull_repo "$rbenv_root"
    pull_repo "$rbenv_root/plugins/ruby-build"
fi

# python
if command -v pyenv >/dev/null 2>&1; then
    pull_repo "$(pyenv root)"
fi

# php
if command -v phpenv >/dev/null 2>&1; then
    phpenv_root="$(phpenv root)"
    pull_repo "$phpenv_root"
    pull_repo "$phpenv_root/plugins/php-build"
    pull_repo "$phpenv_root/plugins/phpenv-composer"
fi

# go
if command -v goenv >/dev/null 2>&1; then
    pull_repo "$(goenv root)"
fi
